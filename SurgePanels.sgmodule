#!name=Surge Patickhuang
#!desc=Surgeè‡ªç”¨ è¿è¡Œæ—¶é—´:é…ç½®é‡è½½/ç½‘ç»œè¯¦æƒ…é¢æ¿/googleé‡å®šå‘/è‡ªåŠ¨åˆ‡æ¢ç­–ç•¥ç»„/å±è”½iOSç³»ç»Ÿæ›´æ–°/BoxJs/Crunchyrollå»å¹¿å‘Š/Safariè°·æ­Œæœç´¢é‡å®šå‘/æµåª’ä½“è§£é”æ£€æµ‹/QXé‡å†™&è§„åˆ™é›†è½¬åŒ–/äº¬ä¸œæ¯”ä»· Lite(é€šçŸ¥ç‰ˆ)/æ·˜å®æ¯”ä»·/HTTP-Capture/AdGuardè§„åˆ™/sileoå—¨å®¢æºä¿®å¤
#!system=ios

[General]
force-http-engine-hosts = %APPEND% boxjs.com, boxjs.net, *.boxjs.com, *.boxjs.netï¼Œwww.baidu.com,yunbusiness.ccb.com,wxh.wo.cn,gate.lagou.com,www.abchina.com.cn,www.shanbay.com,login-service.mobile-bank.psbc.com,mobile-bank.psbc.com

skip-proxy = %APPEND% iosapps.itunes.apple.com

[Rule]
# å±è”½iOSç³»ç»Ÿæ›´æ–°
DOMAIN,gdmf.apple.com,ğŸš« å¹¿å‘Šæ‹¦æˆª

# Surge èƒ½ç›´æ¥ä½¿ç”¨çš„ AdGuard ç»´æŠ¤çš„åŸŸåè§„åˆ™
DOMAIN-SET,https://cdn.jsdelivr.net/gh/geekdada/surge-list/domain-set/social-media-filter.txt,ğŸš« å¹¿å‘Šæ‹¦æˆª
DOMAIN-SET,https://cdn.jsdelivr.net/gh/geekdada/surge-list/domain-set/neohosts.txt,ğŸš« å¹¿å‘Šæ‹¦æˆª
DOMAIN-SET,https://cdn.jsdelivr.net/gh/geekdada/surge-list/domain-set/neohosts-full.txt,ğŸš« å¹¿å‘Šæ‹¦æˆª
DOMAIN-SET,https://cdn.jsdelivr.net/gh/geekdada/surge-list/domain-set/chinese-filter.txt,ğŸš« å¹¿å‘Šæ‹¦æˆª
DOMAIN-SET,https://cdn.jsdelivr.net/gh/geekdada/surge-list/domain-set/base-filter.txt,ğŸš« å¹¿å‘Šæ‹¦æˆª
DOMAIN-SET,https://cdn.jsdelivr.net/gh/geekdada/surge-list/domain-set/annoyances-filter.txt,ğŸš« å¹¿å‘Šæ‹¦æˆª
DOMAIN-SET,https://cdn.jsdelivr.net/gh/geekdada/surge-list/domain-set/adaway.txt,ğŸš« å¹¿å‘Šæ‹¦æˆª

[URL Rewrite]
# è°·æ­Œ
^https?://(www.)?g.cn https://www.google.com 302
^https?://(www.)?google.cn https://www.google.com 302
^https?:\/\/(www.)?(g|google)\.cn https://www.google.com 302

# iPadOS
^https:\/\/mesu\.apple\.com\/assets\/com_apple_MobileAsset_SoftwareUpdate\/com_apple_MobileAsset_SoftwareUpdate\.xml - reject

[Panel]

functionstatus = script-name=functionstatus, title="Surge Pro", content="è¯·åˆ·æ–°", update-interval=60

capture = title = "HTTP Capture", content = "DISABLE", icon = "doc.text.magnifyingglass", icon-color = "FF6D1F", script-name = HTTP-Capture, update-interval = 1

NetInfoPanel=title="",content="",style=info,script-name=net-info-panel.js,update-interval=1

TrafficStatistics = script-name=TrafficStatistics,title=æµé‡ç»Ÿè®¡,content=è¯·åˆ·æ–°,update-interval=1

DNSä¿¡æ¯ = script-name=flushDNS,title=DNSä¿¡æ¯,content=è¯·åˆ·æ–°,update-interval=600

stream-all = script-name=stream-all,title=æµåª’ä½“è§£é”æ£€æµ‹,content=è¯·åˆ·æ–°é¢æ¿,update-interval=-1


[Script]

# é‡è½½é…ç½®
functionstatus = type=generic, script-path=https://raw.githubusercontent.com/Patickhuang/surge/main/functionstatus.js

# HTTP-Capture
HTTP-Capture = type=generic, script-path=https://raw.githubusercontent.com/DecoAri/JavaScript/main/Surge/Capture.js,raw=true

# ç½‘ç»œçŠ¶æ€
net-info-panel.js=script-path=https://raw.githubusercontent.com/Patickhuang/surge/main/networkCheck.js,type=generic

# ç½‘ç»œç•Œé¢
TrafficStatistics = type=generic,timeout=10,script-path=https://raw.githubusercontent.com/Patickhuang/surge/main/trafficstatistics.js,argument=icon=network.badge.shield.half.filled&color=#1E90FF

# DNSä¿¡æ¯
flushDNS = type=generic,timeout=5,script-path=https://raw.githubusercontent.com/Patickhuang/surge/main/flushDNS.js,argument=title=DNSä¿¡æ¯&icon=bonjour&color=#1E90FF

# æµåª’ä½“è§£é”æ£€æµ‹
stream-all = type=generic,timeout=15,script-path=https://raw.githubusercontent.com/Patickhuang/surge/main/stream.js

# è¿è¡Œæ¨¡å¼
event network-changed script-path=https://raw.githubusercontent.com/Patickhuang/surge/main/running-mode.js

# ç­–ç•¥ç»„
event network-changed script-path=https://raw.githubusercontent.com/Patickhuang/surge/main/persistent-policy.js
Persistent-Policy = type=http-request,pattern=https?:\/\/persistent-policy\.com,script-path=https://raw.githubusercontent.com/Patickhuang/surge/main/persistent-policy.js,requires-body=true

# è‡ªåŠ¨ç­–ç•¥
Auto-Policy = script-path=https://raw.githubusercontent.com/Patickhuang/surge/main/auto-policy.js,type=event,event-name=network-changed

# Boxjs
Rewrite: BoxJs = type=http-request,pattern=^https?:\/\/(.+\.)?boxjs\.(com|net),script-path=https://raw.githubusercontent.com/Patickhuang/surge/main/chavy.boxjs.js, requires-body=true, timeout=120

# Crunchyrollå»å¹¿å‘Š
Crunchyroll Adblock = type=http-response,pattern=https://beta-api.crunchyroll.com/cms,requires-body=1,max-size=-1,script-path=https://raw.githubusercontent.com/Marcio2536/MySurge/main/Script/crunchyroll.js,script-update-interval=0

# äº¬ä¸œæ¯”ä»· Lite(é€šçŸ¥ç‰ˆ)
http-response ^https?://api\.m\.jd\.com/(client\.action|api)\?functionId=(wareBusiness|serverConfig|basicConfig|lite_wareBusiness|pingou_item) requires-body=true, script-path=https://raw.githubusercontent.com/Tartarus2014/Script/master/jd_price_lite.js, tag=äº¬ä¸œæ¯”ä»· Lite(é€šçŸ¥ç‰ˆ)

# > æ·˜å®æ¯”ä»·
# Liteå¼¹çª—ç‰ˆ
http-request ^http://.+/amdc/mobileDispatch requires-body=1,script-path=https://raw.githubusercontent.com/yichahucha/surge/master/tb_price_lite.js,tag=æ·˜å®æ¯”ä»·1 Lite(é€šçŸ¥ç‰ˆ)
http-response ^https?://trade-acs\.m\.taobao\.com/gw/mtop\.taobao\.detail\.getdetail requires-body=1,script-path=https://raw.githubusercontent.com/yichahucha/surge/master/tb_price_lite.js,tag=æ·˜å®æ¯”ä»·2 Lite(é€šçŸ¥ç‰ˆ)

è§£é™¤å¾®ä¿¡é“¾æ¥é™åˆ¶ = type=http-response,pattern=^https\:\/\/(weixin110\.qq|security.wechat)\.com\/cgi-bin\/mmspamsupport-bin\/newredirectconfirmcgi\?,requires-body=1,max-size=0,script-path=https://raw.githubusercontent.com/zZPiglet/Task/master/asset/UnblockURLinWeChat.js

# å¾®ä¿¡å»å¹¿å‘Š
http-response ^https?:\/\/mp\.weixin\.qq\.com\/mp\/getappmsgad requires-body=1,max-size=0,script-path=https://raw.githubusercontent.com/NobyDa/Script/master/QuantumultX/File/Wechat.js

# è„šæœ¬è½¬æ¢å™¨
http-response ^https?:\/\/(raw|gist)\.githubusercontent.com/.*\.js$ script-path=https://raw.githubusercontent.com/Peng-YM/ScriptConverter/master/js-converter.js, requires-body = true

# sileoå—¨å®¢æºä¿®å¤
sileoå—¨å®¢æºä¿®å¤ = type=http-request,script-path=https://raw.githubusercontent.com/rartv/SurgeScript/main/Jailbreak/SileoHiKe.js,pattern=https?:\/\/repo\.qqtlr\.com\/\.\/downloads\.php%3Frequest=\d+\.deb,max-size=131072,timeout=10,script-update-interval=0,enable=true

#QXé‡å†™&è§„åˆ™é›†è½¬åŒ–
#!desc=ä½¿ç”¨æ–¹æ³•åœ¨é‡å†™é“¾æ¥æœ«å°¾é¢åŠ ä¸Šqxï¼Œåœ¨è§„åˆ™é›†é“¾æ¥æœ«å°¾åŠ ä¸Šr_parser.list
#!author=@å°ç™½è„¸ 
#!ä½¿ç”¨æ‰‹å†Œhttps://github.com/chengkongyiban/stash/tree/main/Rewrite_Parser_Wiki
QXè½¬æ¢ = type=http-request,pattern=\/[^/]+\.[^/]+qx$|qx\?(jsc|hnadd|hndel|n|y|x|del|i)=,requires-body=1,max-size=0,script-path=https://github.com/chengkongyiban/stash/raw/main/js/QX_Rewrite_Parser.js ,timeout=60

è§„åˆ™é›†è½¬æ¢ = type=http-request,pattern=r_parser.list$|r_parser.list\?.*,requires-body=1,max-size=0,script-path=https://raw.githubusercontent.com/chengkongyiban/stash/main/js/rule_parser.js ,timeout=60

#åœ¨QXè„šæœ¬ç»“å°¾åŠ ä¸Š _script-converter-(stash|surge|loon|shadowrocket).js æ ¹æ®ä½ è‡ªå·±çš„appå¡«å†™
è„šæœ¬è½¬æ¢ = type=http-request,pattern=_script-converter-(stash|surge|loon|shadowrocket)\.js$,requires-body=1,max-size=0,script-path=https://raw.githubusercontent.com/xream/scripts/main/surge/modules/script-converter/script-converter.js, time=60

[Host]
ip-api.com = 208.95.112.1

[MITM]
hostname = %APPEND% boxjs.com,boxjs.net,*.boxjs.com,*.boxjs.net,github.com:443, raw.githubusercontent.com:443,gist.githubusercontent.com,gitlab.com,trade-acs.m.taobao.com,persistent-policy.com,www.google.cn, www.g.cn,testflight.apple.com,beta-api.crunchyroll.com,api.m.jd.com,mp.weixin.qq.com,weixin110.qq.com,testflight.apple.com,security.wechat.com,mesu.apple.com,-mesu.apple.com
